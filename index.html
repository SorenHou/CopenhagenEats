<!DOCTYPE html>
<html>
  <head>
    <title>Copenhagen Eats</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Oswald&display=swap" />
<style>
  /* Add the font-family property to your header and pane */
  header,
  #locations-pane {
    font-family: 'Oswald', sans-serif;
    box-sizing: border-box; /* Include padding and border within the element's dimensions */
  }

  #map {
    width: 80%;
    height: 100%;
  }
  html,
  body {
    height: 100%;
    margin: 0;
    padding: 0;
    background-color: #f1f1f1;
  }
  header {
    text-align: center;
    padding: 5px;
    background-color: #f1f1f1;
    height: 20%; /* Adjust the header height */
  }
  /* Add any other CSS properties you want for your pane */
  #locations-pane {
    font-size: 16px;
  }

  .main-container {
    display: flex;
    height: 80%; /* Set the height of the main container */
  }

  #map {
    width: 80%;
    height: 100%;
  }

  #locations-pane {
    width: 20%;
    height: 100%;
    overflow-y: auto;
    padding: 10px;
  }
  
  /* Increase the font size of the header text and reduce line-height */
  header h1 {
    font-size: 100px;
    line-height: 0.8; /* Adjust the line-height to control the space around the header text */
    margin-top: 0; /* Remove space above the header h1 */
  }
  
  header p {
    font-size: 18px;
    line-height: 1.2; /* Adjust the line-height for the description text */
    margin-top: 0; /* Remove space above the header p */
  }
</style>

  </head>
  <body>
    <header>
      <h1>Copenhagen Eats</h1>
      <p>Discover great places to eat in Copenhagen</p>
    </header>

    <div class="main-container">
      <div id="map"></div>
      <div id="locations-pane"></div>
    </div>

    <script>
      
async function fetchLocationDataFromKml() {
  const response = await fetch('https://raw.githubusercontent.com/SorenHou/CopenhagenEats/main/MapFile.kml');
  const data = await response.text();
  const parser = new DOMParser();
  const kml = parser.parseFromString(data, 'application/xml');

  const folders = kml.querySelectorAll('Folder');
  console.log('Folders:', folders.length); // Added console log
  folders.forEach((folder, folderIndex) => {
    const placemarks = folder.querySelectorAll('Placemark');
    console.log(`Folder ${folderIndex + 1} Placemarks:`, placemarks.length); // Added console log
    placemarks.forEach((placemark) => {
      const name = placemark.querySelector('name').textContent;
      const description = placemark.querySelector('description').textContent;
      const coordinatesText = placemark.querySelector('coordinates').textContent;
      const coordinatesArray = coordinatesText.split(',').map(parseFloat);
      const locationCoords = {
        lat: coordinatesArray[1],
        lng: coordinatesArray[0],
      };

      const styleUrl = placemark.querySelector('styleUrl').textContent;
      const iconStyle = kml.querySelector(`Style[id="${styleUrl.slice(1)}"]`);
      const iconHrefElement = iconStyle.querySelector('href'); // Changed variable name
      const iconHref = iconHrefElement ? iconHrefElement.textContent : ''; // Check if iconHrefElement exists
      
      const locationDiv = document.createElement('div');
      locationDiv.classList.add('location');

      const locationName = document.createElement('h3');
      locationName.textContent = name;
      locationDiv.appendChild(locationName);

      const locationDescription = document.createElement('p');
      locationDescription.textContent = description;
      locationDiv.appendChild(locationDescription);

      locationDiv.addEventListener('click', () => {
        map.setCenter(locationCoords);
        map.setZoom(16);
      });

      const locationsPane = document.getElementById('locations-pane');
      locationsPane.appendChild(locationDiv);

      const marker = new google.maps.Marker({
        position: locationCoords,
        map: map,
        title: name,
        icon: iconHref,
      });

      const infowindow = new google.maps.InfoWindow({
        content: `<h3>${name}</h3><p>${description}</p>`,
      });

      marker.addListener('click', () => {
        infowindow.open(map, marker);
      });
    });
  });
}

    
      let map;

      function initMap() {
        map = new google.maps.Map(document.getElementById('map'), {
          zoom: 12,
          center: { lat: 55.6761, lng: 12.5683 }, // Center the map on Copenhagen
        });
        
        fetchLocationDataFromKml();
      }

      // Load the Google Maps API script
    </script>
    <script
      async
      defer
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDTV1aLFYT4vIK6FhFJnqRflsrtRGpbd1I&callback=initMap"
    ></script>
  </body>
</html>
